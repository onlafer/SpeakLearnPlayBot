# SpeakLearnPlayBot - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç —Å –∏–≥—Ä–∞–º–∏

–ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π Telegram –±–æ—Ç –Ω–∞ aiogram —Å —Å–∏—Å—Ç–µ–º–æ–π –∏–≥—Ä –∏ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üéÆ **–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–≥—Ä** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è–π—Ç–µ –Ω–æ–≤—ã–µ –∏–≥—Ä—ã
- üé§ **–ì–æ–ª–æ—Å–æ–≤–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ Whisper
- üìö **–ü—Ä–∏–º–µ—Ä—ã –∏–≥—Ä**: –∫–≤–∏–∑ —Å –≤—ã–±–æ—Ä–æ–º –æ—Ç–≤–µ—Ç–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏—Å—Ç–æ—Ä–∏–π
- üîß **–ü—Ä–æ—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –Ω–∞—Å–ª–µ–¥—É–π—Ç–µ—Å—å –æ—Ç BaseGame –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∏–≥—Ä

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ games/                    # –°–∏—Å—Ç–µ–º–∞ –∏–≥—Ä
‚îÇ   ‚îú‚îÄ‚îÄ base.py              # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –∏–≥—Ä—ã –∏ —Ä–µ–µ—Å—Ç—Ä
‚îÇ   ‚îú‚îÄ‚îÄ quiz_game.py         # –ü—Ä–∏–º–µ—Ä: –∫–≤–∏–∑
‚îÇ   ‚îú‚îÄ‚îÄ story_game.py        # –ü—Ä–∏–º–µ—Ä: –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏—Å—Ç–æ—Ä–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ session_manager.py   # –ú–µ–Ω–µ–¥–∂–µ—Ä —Å–µ—Å—Å–∏–π –∏–≥—Ä
‚îú‚îÄ‚îÄ handlers/                 # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ common/              # –û–±—â–∏–µ –∫–æ–º–∞–Ω–¥—ã (/start, /menu)
‚îÇ   ‚îú‚îÄ‚îÄ user/                # –ò–≥—Ä–æ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ admin/               # –ê–¥–º–∏–Ω —Ñ—É–Ω–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ keyboards/               # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ utils/                    # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ voice_recognition.py # –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –≥–æ–ª–æ—Å–∞
‚îî‚îÄ‚îÄ main.py                  # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

2. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:
```env
BOT_TOKEN=your_telegram_bot_token
ADMIN_LIST=[123456789]
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:
```bash
python main.py
```

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∏–≥—Ä—ã

–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ñ–∞–π–ª –≤ –ø–∞–ø–∫–µ `games/`, –Ω–∞–ø—Ä–∏–º–µ—Ä `my_game.py`:

```python
from games.base import BaseGame, GameSession, GameStatus, game_registry
from aiogram import Bot
from aiogram.types import Message, CallbackQuery

class MyGame(BaseGame):
    def __init__(self):
        super().__init__(
            game_id="my_game",
            display_name="üéÆ –ú–æ—è –∏–≥—Ä–∞",
            description="–û–ø–∏—Å–∞–Ω–∏–µ –∏–≥—Ä—ã"
        )
    
    async def start_game(self, bot: Bot, user_id: int, message: Message) -> GameSession:
        """–ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã"""
        session = GameSession(
            game_id=self.game_id,
            user_id=user_id,
            status=GameStatus.ACTIVE,
            data={"my_data": "value"}
        )
        await bot.send_message(user_id, "–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å!")
        return session
    
    async def handle_message(self, bot: Bot, session: GameSession, message: Message) -> GameSession:
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π"""
        # –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –∑–¥–µ—Å—å
        return session
    
    async def handle_callback(self, bot: Bot, session: GameSession, callback: CallbackQuery) -> GameSession:
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ callback –∑–∞–ø—Ä–æ—Å–æ–≤"""
        # –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –∑–¥–µ—Å—å
        return session
    
    async def handle_voice(self, bot: Bot, session: GameSession, message: Message) -> GameSession:
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π"""
        # –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –∑–¥–µ—Å—å
        return session

# –ê–≤—Ç–æ-—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏–≥—Ä—ã
_my_game = MyGame()
game_registry.register(_my_game)
```

–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∏–≥—Ä—É –≤ `main.py`:

```python
from games import my_game  # noqa: F401
```

## –ö–æ–º–∞–Ω–¥—ã

- `/start` - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
- `/menu` - –ü–æ–∫–∞–∑–∞—Ç—å –º–µ–Ω—é
- `/cancel` - –û—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é –∏–≥—Ä—É

## –ì–æ–ª–æ—Å–æ–≤–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ

–ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ OpenAI Whisper. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
pip install openai-whisper ffmpeg-python
```

–ò —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ FFmpeg:

**Windows:**
```bash
# –°–∫–∞—á–∞–π—Ç–µ ffmpeg –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ PATH
```

**Linux:**
```bash
sudo apt-get install ffmpeg
```

**macOS:**
```bash
brew install ffmpeg
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ë–∞–∑–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–≥—Ä

–ö–∞–∂–¥–∞—è –∏–≥—Ä–∞ –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç `BaseGame` –∏ —Ä–µ–∞–ª–∏–∑—É–µ—Ç 4 –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–µ—Ç–æ–¥–∞:
- `start_game()` - –∑–∞–ø—É—Å–∫ –∏–≥—Ä—ã
- `handle_message()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- `handle_callback()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ callback'–æ–≤
- `handle_voice()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

### –†–µ–µ—Å—Ç—Ä –∏–≥—Ä

–í—Å–µ –∏–≥—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –≤ `game_registry`. –°–∏—Å—Ç–µ–º–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–≥—Ä.

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏

`GameSessionManager` –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ –∏–≥—Ä–æ–≤—ã–µ —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ö–∞–∂–¥–∞—è –∏–≥—Ä–∞ –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ –≤ `session.data`.

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ö–≤–∏–∑
- –í—ã–±–æ—Ä –æ—Ç–≤–µ—Ç–∞ —á–µ—Ä–µ–∑ inline-–∫–Ω–æ–ø–∫–∏
- –ü–æ–¥—Å—á–µ—Ç –±–∞–ª–ª–æ–≤
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏—Å—Ç–æ—Ä–∏–π
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–π
- –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø–æ –∑–∞–ø—Ä–æ—Å—É
- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–æ –∫–æ–º–∞–Ω–¥–µ

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É:
1. –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å, –Ω–∞—Å–ª–µ–¥—É—é—â–∏–π—Å—è –æ—Ç `BaseGame`
2. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
3. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –∏–≥—Ä—É –≤ `game_registry`
4. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ `main.py`

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

